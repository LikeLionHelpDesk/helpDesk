<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>index</title>
</head>
<body>
    <a href="users/signup">
        <button> sign up(회원가입)</button>
    </a>
    {% if user.is_authenticated %}
    <a href="users/logout">
        <button>{{ user.username }} (로그아웃)</button>
    </a>
    <a href="profile/{{user.pk}}">
        <button>마이페이지</button>
    </a>
    {% else %}
    <a href="users/login">
        <button>로그인</button>
    </a>
    {% endif %}
    <br>
    <form action="{% url 'index' %}" method="POST">
        {% csrf_token %}
        조회 : <input type="text" name = "author" value="{{test.subject}}">
        <input type="submit" value="조회">
    </form>
    <table>많이 본 Q&A
        <thead>
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>작성자</th>
                <th>작성일시</th>
                <th>댓글수</th>
                <th>조회수</th>
            </tr>
        </thead>
        <tbody>
            {% if new_question %}
            {% for question in new_question %}
            <tr>
                <td>
                    {{forloop.counter}}
                </td>
                <td>
                    <a href="/articles/detail/{{ question.id }}">{{ question.subject }}</a>
                </td>
                <td>
                    <a href="profile/{{question.author.pk}}">
                        {{question.author.profile.nickname}}
                    </a>
                </td>
                <td>
                    {{question.create_date}}
                </td>
                <td>
                    {% if question.answer_set.count >= 0 %}
                    <span>{{ question.answer_set.count }}</span>
                    {% endif %}
                </td>
                <td>
                    {{question.count}}
                </td>
            </tr>
            {% endfor %}
            {% else %}
            <p>질문이 없습니다.</p>
            {% endif %}
        </tbody>    
    </table>

    <table>최근 질문
        <thead>
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>작성자</th>
                <th>작성일시</th>
                <th>댓글수</th>
                <th>조회수</th>
            </tr>
        </thead>
        <tbody>
            {% if question_list %}
            {% for question in question_list %}
            <tr>
                <td>
                    {{forloop.counter}}
                </td>
                <td>
                    <a href="/articles/detail/{{ question.id }}">{{ question.subject }}</a>
                </td>
                <td>
                    <a href="profile/{{question.author.pk}}">
                        {{question.author.profile.nickname}}
                    </a>
                </td>
                <td>
                    {{question.create_date}}
                </td>
                <td>
                    {% if question.answer_set.count >= 0 %}
                    <span>{{ question.answer_set.count }}</span>
                    {% endif %}
                </td>
                <td>
                    {{question.count}}
                </td>
            </tr>
            {% endfor %}
            {% else %}
            <p>질문이 없습니다.</p>
            {% endif %}
        </tbody>    
    </table>
    <a href="/articles/new">
        <button>질문 등록하기</button>
    </a>
    <ul>
        <!-- 이전페이지 -->
        {% if question_list.has_previous %}
        <li >
            <a href="?page={{ question_list.previous_page_number }}">이전</a>
        </li>
        {% else %}
        <li >
            <a tabindex="-1" href="#">이전</a>
        </li>
        {% endif %}
        <!-- 페이지리스트 -->
        {% for page_number in question_list.paginator.page_range %}
        {% if page_number == question_list.number %}
        <li>
            <a href="?page={{ page_number }}">{{ page_number }}</a>
        </li>
        {% else %}
        <li>
            <a href="?page={{ page_number }}">{{ page_number }}</a>
        </li>
        {% endif %}
        {% endfor %}
        <!-- 다음페이지 -->
        {% if question_list.has_next %}
        <li>
            <a href="?page={{ question_list.next_page_number }}">다음</a>
        </li>
        {% else %}
        <li >
            <a tabindex="-1" href="#">다음</a>
        </li>
        {% endif %}
    </ul>
</body>
</html>